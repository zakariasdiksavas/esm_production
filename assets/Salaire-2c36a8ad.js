import{a2 as U,ao as Oe,a6 as I,d as T,r as j,j as e,a7 as H,X as Ee,l as s,a1 as R,a as Y,h as V,bE as d,Y as _,b3 as Fe,T as Z,B as we,a3 as ue,bC as Ae,V as B,al as Me,ab as A,ac as P,ad as M,ae as v,k as z,F as k}from"./index-bffffd5d.js";import{B as Q,j as Ue,e as he,T as xe,a as ge,b as W,c as g,d as ve,f as Te,g as ie,G as D,u as oe,S as N,h as le,E as je}from"./moment-c1228ca8.js";import{E as Re,P as Ie,M as De}from"./ModalDelete-6c83eee3.js";import{u as Ge,C as Le,T as We}from"./index-c64b3ee1.js";import{C as ee,T as Be}from"./TableRowsLoader-1fe09bf9.js";import{E as Ne}from"./Eye-0948d72f.js";import{A as ke,K as Ye,a as He}from"./KeyboardArrowUp-4b584357.js";import{A as Ve}from"./AlertError-b5da0392.js";import{D as $e}from"./DeleteOutlineOutlined-6b34994d.js";import{A as Ke}from"./Add-ee847921.js";import{u as de,c as ce,e as Ce,C as fe,b as qe,d as X}from"./formik.esm-51017e53.js";import{A as ze,a as Xe,F as Je,b as Ze}from"./fr-a1d10d63.js";import{E as Qe}from"./ExpandMore-933c5590.js";import{D as J}from"./DatePicker-b45e2a50.js";import{C as es}from"./Container-76ca21d5.js";import{M as ss}from"./ModalConfirm-f66dfd05.js";const as=u=>({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:500,bgcolor:"background.paper",boxShadow:24,p:4,[u.breakpoints.down("md")]:{width:"95%"}}),ts=["application/pdf","image/jpg","image/jpeg","image/png"];function ns({isModalUpload:u,close:l,isFournisseur:r}){var K;const m=U(),h=Oe(),{currentData:a}=I(x=>x.salaire),{t:o,i18n:t}=T(),[n,b]=j.useState([]),[p,i]=j.useState(4-((K=a==null?void 0:a.expenses_proof)==null?void 0:K.length)-n.length),[f,F]=j.useState(!1),{acceptedFiles:O,getRootProps:E,getInputProps:se}=Ge({onDrop:(x,C)=>{var w;if(C.length>0){if(C[0].errors[0].code=="too-many-files"){_.error(o(s.paiment.uploadLimitFile)+` ${4-((w=a==null?void 0:a.expenses_proof)==null?void 0:w.length)}`);return}else if(C[0].errors[0].code=="file-invalid-type"){_.error(o(s.paiment.fileSupported));return}_.error(C[0].errors[0].message)}b(L=>[...L,...x])},multiple:!0,maxFiles:p,validator:te,accept:{"application/pdf":[],"image/jpeg":[],"image/jpg":[],"image/png":[]}}),S=()=>{F(!0);const x=new FormData;x.append("id",a.id),n.map(C=>{x.append("files",C)}),V.post("/employeewage/proof/add/",x).then(C=>{m(d.actions.addProofSalaire(C.data)),_.success(o(s.paiment.toastUploadFile)),F(!1),l(),b([])})},ae=x=>{const C=n.findIndex(L=>L.path==x),w=n.filter((L,ne)=>ne!==C);b(w)};function te(x){var w;if(!ts.includes(x.type))return{code:"extension-supported",message:o(s.paiment.fileSupported)};const C=5*1024*1024;return x.size>C?{code:"max-size",message:o(s.paiment.uploadMaxSize)}:p<=0?{code:"max-file",message:`${o(s.paiment.uploadLimitFile)} ${4-((w=a==null?void 0:a.expenses_proof)==null?void 0:w.length)}`}:null}return j.useEffect(()=>{var x;n.length>0&&i(4-((x=a==null?void 0:a.expenses_proof)==null?void 0:x.length)-n.length)},[n.length]),e.jsx(e.Fragment,{children:e.jsx(H,{open:u,onClose:l,children:e.jsxs(Q,{sx:as(h),children:[f&&e.jsx(Ee,{}),e.jsx("h3",{className:"text-center font-semibold text-lg",children:o(s.paiment.uploadTitle)}),e.jsxs("div",{className:"flex flex-col items-center my-4 border-2 border-dashed border-purple-500 p-4",...E(),children:[e.jsx("input",{...se()}),e.jsx(Le,{color:"primary",fontSize:"large"}),e.jsx("p",{children:o(s.paiment.uploadTitle)}),e.jsxs("p",{children:[o(s.paiment.uploadMessage)," PNG, JPG, JPEG, PDF"]})]}),e.jsx("div",{children:n.map((x,C)=>e.jsxs("p",{children:[x.path," ",e.jsx(R,{onClick:()=>ae(x.path),children:e.jsx(ee,{color:"error"})})]},C))}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Y,{onClick:S,variant:"contained",color:"primary",children:o(s.paiment.upload)})})]})})})}function rs({close:u,isPreview:l,file:r}){const[m,h]=j.useState(null);return j.useEffect(()=>(console.log(r),(async()=>{try{console.log(r.file);const o=await V.get(r.file,{responseType:"blob"}),t=URL.createObjectURL(o.data);console.log(t),h(t)}catch(o){console.error("Error fetching PDF:",o)}})(),()=>{m&&URL.revokeObjectURL(m)}),[]),e.jsxs(Fe,{fullScreen:!0,open:l,children:[e.jsx(ke,{sx:{position:"relative"},children:e.jsxs(Ue,{children:[e.jsx(R,{edge:"start",color:"inherit","aria-label":"close",onClick:()=>u(),children:e.jsx(ee,{})}),e.jsx(Z,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:"Preview File"})]})}),e.jsx("iframe",{src:m,height:"100%"})]})}const os=j.memo(u=>{const l=U();let{count:r=0,items:m=[],onDeselectAll:h,onDeselectOne:a,onSelectAll:o,onSelectOne:t,selected:n=[],isLoading:b,isError:p}=u;const[i,f]=j.useState(0),[F,O]=j.useState(!1),[E,se]=j.useState(25),{t:S,i18n:ae}=T(),[te,K]=j.useState({}),[x,C]=j.useState(!1),[w,L]=j.useState();j.useState(),j.useState(null);const ne=c=>{K(y=>({...y,[c]:!y[c]}))},re=(c,y)=>{const G=m.filter($=>$.id==c);l(d.actions.setCurrentData(G[0])),y=="update"?l(d.actions.openCloseModalUpdate()):y=="delete"?l(d.actions.openCloseModalDelete()):O(!0)},Se=(c,y)=>{f(y)},ye=c=>{se(parseInt(c.target.value,10)),f(0)},me=m==null?void 0:m.slice(i*E,i*E+E);return e.jsxs(e.Fragment,{children:[e.jsxs(we,{sx:{position:"relative"},children:[e.jsx(he,{component:ue,children:e.jsxs(xe,{sx:{minWidth:700},children:[e.jsx(ge,{children:e.jsxs(W,{children:[e.jsx(g,{align:"left"}),e.jsx(g,{children:S(s.employee.salarie)}),e.jsxs(g,{children:[S(s.paiment.amount)," ",S(s.global.mad)]}),e.jsx(g,{children:S(s.entrer.date)}),e.jsx(g,{children:S(s.salaire.periode)}),e.jsx(g,{sx:{width:"5%"},children:S(s.salaire.observation)}),e.jsx(g,{})]})}),b?e.jsx(Be,{rowsNum:10}):e.jsx(ve,{children:me.length>0?me.map(c=>{var pe;const y=te[c.id]||!1;let G=new Date(c.date),$={year:G.getFullYear(),month:`${G.getMonth()+1}`,day:`${G.getDate()}`};const _e=new Intl.NumberFormat("en-US",{style:"currency",currency:"MAD"});return e.jsxs(e.Fragment,{children:[e.jsxs(W,{hover:!0,children:[e.jsx(g,{sx:{width:"5%"},children:c.wages_proof.length!==0&&e.jsx(R,{"aria-label":"expand row",size:"small",onClick:()=>ne(c.id),children:y?e.jsx(Ye,{}):e.jsx(He,{})})}),e.jsxs(g,{children:[c.first_name," ",c.last_name]}),e.jsx(g,{sx:{direction:ae.language=="ar"?"rtl":"ltr",whiteSpace:"nowrap"},children:_e.format(c.amount).replaceAll(","," ").replace("MAD","")}),e.jsxs(g,{children:[" ",$.day.padStart(2,0),"/",$.month.padStart(2,0),"/",$.year]}),e.jsx(g,{children:c.year!==null&&c.month!==null?`${c.month}`.padStart("2","0")+"/"+c.year:""}),e.jsx(g,{children:e.jsx(Ae,{title:c.observation,children:c.observation?c.observation.length>10?((pe=c.observation)==null?void 0:pe.slice(0,10))+"...":c.observation:""})}),e.jsx(g,{children:c.is_active&&e.jsxs(e.Fragment,{children:[e.jsx(R,{color:"warning",onClick:()=>re(c.id,"update"),children:e.jsx(B,{children:e.jsx(Re,{})})}),e.jsx(R,{color:"error",onClick:()=>re(c.id,"delete"),children:e.jsx(B,{children:e.jsx($e,{})})}),c.wages_proof.length!==4&&e.jsx(R,{color:"success",onClick:()=>re(c.id,"upload"),children:e.jsx(B,{children:e.jsx(Ke,{})})})]})})]},c.id),e.jsx(W,{children:e.jsx(g,{style:{paddingBottom:0,paddingTop:0},colSpan:8,children:e.jsx(Me,{in:y,timeout:"auto",unmountOnExit:!0,children:e.jsx(he,{sx:{width:"100%"},component:ue,children:e.jsxs(xe,{sx:{width:"100%"},children:[e.jsx(ge,{children:e.jsxs(W,{children:[e.jsx(g,{children:S(s.paiment.fileName)}),e.jsx(g,{})]})}),e.jsx(ve,{children:c.wages_proof.map((q,Pe)=>e.jsxs(W,{children:[e.jsx(g,{children:q.file.replace("http://192.168.1.97:8000/api".replace("/api","")+"/uploads/","")}),e.jsxs(g,{children:[" ",e.jsx(R,{color:"inherit",onClick:()=>{l(d.actions.openCloseConfirmDeleteProof()),l(d.actions.setCurrentData({id:c.id,idFile:q.id}))},children:e.jsx(B,{children:e.jsx(We,{})})}),e.jsx(R,{color:"secondary",onClick:()=>{L({file:q.file,extension:q.extension}),C(!0)},children:e.jsx(B,{children:e.jsx(Ne,{})})})]})]},Pe))})]})})})})})]})}):e.jsx(W,{children:e.jsx(g,{colSpan:5,sx:{textAlign:"center"},children:S(s.batiment.nothingToDisplay)})})})]})}),e.jsx(Te,{component:"div",count:r,onPageChange:Se,onRowsPerPageChange:ye,page:i,rowsPerPage:E,rowsPerPageOptions:[5,10,25],labelRowsPerPage:S(s.batiment.Lignes),labelDisplayedRows:({from:c,to:y,count:G})=>`${c}â€“${y} ${S(s.batiment.sur)} ${G}`}),p&&e.jsx(Ve,{})]}),F&&e.jsx(ns,{isModalUpload:F,close:()=>O(!1)}),x&&e.jsx(rs,{isPreview:x,close:()=>C(!1),file:w})]})});function ls({employee:u}){ie.locale("fr");const{t:l,i18n:r}=T(),m=U(),h=new Date,a=de({initialValues:{date1:null,date2:null,employee:""},validationSchema:ce({date1:Ce().nullable().test("is-before-date2",l(s.global.date2Greather),function(o){const{date2:t}=this.parent;return o<=t}),date2:Ce().nullable().test("is-after-date1",l(s.global.date2Greather),function(o){const{date1:t}=this.parent;return o>=t})}),onSubmit:async(o,{resetForm:t,setErrors:n})=>{let b="";for(let p in o)if(o[p]!==""&&o[p]!==null){let i=new Date(o[p]),f=i.getFullYear()!==1970?`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`:o[p];b==""?b+=`?${p}=${f}`:b+=`&${p}=${f}`}m(d.actions.setLink(b))},onReset:()=>{m(d.actions.setLink(""))}});return e.jsxs(ze,{defaultExpanded:!0,children:[e.jsx(Xe,{expandIcon:e.jsx(Qe,{}),"aria-controls":"panel1-content",id:"panel1-header",children:e.jsxs("h3",{className:"font-bold text-lg",children:[e.jsx(Je,{}),l(s.global.filter)]})}),e.jsx(Ze,{children:e.jsx(fe,{children:e.jsx(qe,{children:e.jsx("form",{noValidate:!0,onSubmit:a.handleSubmit,onReset:a.handleReset,children:e.jsxs(D,{container:!0,alignItems:"center",gap:2,children:[e.jsx(D,{item:!0,xs:12,md:5,sm:12,children:e.jsxs(A,{fullWidth:!0,children:[e.jsx(P,{id:"batiment-id",children:l(s.employee.title)}),e.jsx(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:a.handleBlur,fullWidth:!0,name:"employee",onChange:a.handleChange,value:a.values.employee,label:l(s.employee.title),children:u==null?void 0:u.map(o=>e.jsxs(v,{value:o.id,children:[o.first_name," ",o.last_name]}))})]})}),e.jsx(D,{item:!0,xs:3,children:e.jsxs(A,{fullWidth:!0,error:!!(a.touched.type&&a.errors.type),children:[e.jsx(P,{id:"batiment-id",children:l(s.salaire.month)}),e.jsx(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:a.handleBlur,fullWidth:!0,name:"month",onChange:a.handleChange,value:a.values.month,label:l(s.salaire.month),children:[...Array(12)].map((o,t)=>e.jsx(v,{value:t+1,children:t+1}))}),a.touched.month&&a.errors.month&&e.jsx(FormHelperText,{children:a.errors.month})]})}),e.jsx(D,{item:!0,xs:3,children:e.jsxs(A,{fullWidth:!0,error:!!(a.touched.type&&a.errors.type),children:[e.jsx(P,{id:"batiment-id",children:l(s.salaire.year)}),e.jsxs(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:a.handleBlur,fullWidth:!0,name:"year",onChange:a.handleChange,value:a.values.year,label:l(s.salaire.year),children:[e.jsx(v,{value:h.getFullYear()-1,children:h.getFullYear()-1}),e.jsx(v,{value:h.getFullYear(),children:h.getFullYear()}),e.jsx(v,{value:h.getFullYear()+1,children:h.getFullYear()+1}),e.jsx(v,{value:h.getFullYear()+2,children:h.getFullYear()+2})]}),a.touched.year&&a.errors.year&&e.jsx(FormHelperText,{children:a.errors.year})]})}),e.jsx(D,{item:!0,xs:12,md:2,sm:12,children:e.jsx(J,{value:a.values.date1,onChange:o=>a.setFieldValue("date1",o),onBlur:a.handleBlur,label:l(s.global.date1),name:"date",slotProps:{textField:{variant:"outlined",error:!!(a.touched.date1&&a.errors.date1),helperText:a.touched.date1&&a.errors.date1}}})}),e.jsx(D,{item:!0,xs:12,md:2,sm:12,children:e.jsx(J,{value:a.values.date2,onChange:o=>a.setFieldValue("date2",o),onBlur:a.handleBlur,label:l(s.global.date2),name:"date",slotProps:{textField:{variant:"outlined",error:!!(a.touched.date2&&a.errors.date2),helperText:a.touched.date2&&a.errors.date2}}})}),e.jsxs(D,{item:!0,container:!0,xs:12,md:12,sm:12,gap:2,sx:{alignContent:"center",justifyContent:"end"},children:[e.jsx(D,{items:!0,children:e.jsx(Y,{variant:"contained",type:"reset",children:l(s.global.reset)})}),e.jsx(D,{items:!0,children:e.jsx(Y,{type:"submit",variant:"contained",children:l(s.global.filter)})})]})]})})})})})]})}function is(){const u=U(),{t:l,i18n:r}=T(),{salaire:m,link:h}=I(t=>t.salaire),a=oe(["salaire",h],()=>le.fetchSalaire(h)),o=oe("employee",le.fetchOeuvreList);return j.useEffect(()=>{a.status=="success"&&u(d.actions.fetchSalaire(a.data))},[a.status,h]),e.jsx(es,{maxWidth:"xl",children:e.jsxs(N,{spacing:4,children:[e.jsxs(N,{direction:"row",justifyContent:"space-between",spacing:4,children:[e.jsx(N,{spacing:1,children:e.jsx(Z,{variant:"h4",children:l(s.salaire.title)})}),e.jsx(N,{alignItems:"center",direction:"row",spacing:3,children:e.jsx(Y,{startIcon:e.jsx(B,{children:e.jsx(Ie,{})}),variant:"contained",onClick:()=>u(d.actions.openCloseModalAdd()),children:l(s.global.ajouter)})})]}),e.jsxs(fe,{children:[e.jsx(ls,{employee:o.data}),e.jsx(os,{items:m,count:m.length,rowsPerPage:25,isLoading:a.isLoading,isError:a.isError})]})]})})}function be({confirmed:u}){const{currentData:l,isConfirm:r}=I(t=>t.salaire),m=U(),{t:h,i18n:a}=T(),o=()=>{u()};return e.jsx(H,{open:r,onClose:()=>m(d.actions.openCloseConfirm()),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:e.jsx(ss,{title:h(s.global.confirmOperation),message:h(s.global.confirmMessage),confirmFn:o,cancel:()=>m(d.actions.openCloseConfirm())})})}const ds={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function cs({employee:u}){const l=U(),{t:r,i18n:m}=T(),{currentData:h,isModalUpdate:a}=I(i=>i.salaire),o=new Date,t=ce({amount:X().required(r(s.paiment.amountRequired)),employee:X().required(r(s.salaire.employeeRequired))}),n=de({initialValues:{amount:0,observation:null,employee:"",date:new Date,month:"",year:""},validationSchema:t,onSubmit:async(i,{resetForm:f,setErrors:F})=>{const O={...i};O.date=ie(i.date).format("YYYY-MM-DD"),V.put("/employeewage/update/",O).then(E=>{l(d.actions.editSalaire(E.data)),l(d.actions.openCloseModalUpdate()),l(d.actions.openCloseConfirm()),_.success(r(s.salaire.toastUpdateSuccess)),f()}).catch(E=>{console.log(E),l(d.actions.openCloseConfirm()),_.error(r(s.global.toastError))})}}),b=async i=>{i.preventDefault();const f=await n.validateForm();Object.keys(f).length===0?l(d.actions.openCloseConfirm()):await n.submitForm()},p=()=>{n.handleSubmit()};return j.useEffect(()=>{const i={...h};i.date=new Date(i.date),n.setValues(i)},[]),e.jsxs(e.Fragment,{children:[e.jsx(H,{open:a,onClose:()=>l(d.actions.openCloseModalUpdate()),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(Q,{sx:ds,children:[e.jsxs(N,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"20px"},children:[e.jsx(Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:r(s.salaire.updateTitle)}),e.jsx("div",{className:"cursor-pointer",onClick:()=>l(d.actions.openCloseModalUpdate()),children:e.jsx(ee,{})})]}),e.jsxs("form",{noValidate:!0,onSubmit:i=>b(i),children:[e.jsx(z,{id:"outlined-basic",label:r(s.paiment.amount),variant:"outlined",onBlur:n.handleBlur,fullWidth:!0,type:"number",name:"amount",onChange:n.handleChange,value:n.values.amount,error:!!(n.touched.amount&&n.errors.amount),helperText:n.touched.amount&&n.errors.amount,style:{marginBottom:"15px"}}),e.jsx(z,{id:"outlined-basic",label:r(s.salaire.observation),variant:"outlined",onBlur:n.handleBlur,fullWidth:!0,multiline:!0,maxRows:4,name:"observation",onChange:n.handleChange,value:n.values.observation,error:!!(n.touched.observation&&n.errors.observation),helperText:n.touched.observation&&n.errors.observation,style:{marginBottom:"15px"}}),e.jsxs(A,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(n.touched.employee&&n.errors.employee),children:[e.jsx(P,{id:"batiment-id",error:!!(n.touched.employee&&n.errors.employee),children:r(s.employee.title)}),e.jsx(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:n.handleBlur,fullWidth:!0,name:"employee",onChange:n.handleChange,value:n.values.employee,label:r(s.employee.title),error:!!(n.touched.employee&&n.errors.employee),children:u.length>0?u.map(i=>e.jsxs(v,{value:i.id,children:[i.first_name," ",i.last_name]})):e.jsx(v,{children:r(s.batiment.nothingToDisplay)})}),n.touched.employee&&n.errors.employee&&e.jsx(k,{children:n.errors.employee})]}),e.jsx(J,{label:r(s.entrer.date),value:n.values.date,onChange:i=>n.setFieldValue("date",i),onBlur:n.handleBlur,name:"date",sx:{width:"100%"}}),e.jsx(D,{xs:12,mt:.8,mb:.9,children:e.jsx(P,{children:r(s.salaire.periode)})}),e.jsxs(D,{container:!0,spacing:2,children:[e.jsx(D,{item:!0,xs:6,children:e.jsxs(A,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(n.touched.type&&n.errors.type),children:[e.jsx(P,{id:"batiment-id",children:r(s.salaire.month)}),e.jsx(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:n.handleBlur,fullWidth:!0,name:"month",onChange:n.handleChange,value:n.values.month,label:r(s.salaire.month),children:[...Array(12)].map((i,f)=>e.jsx(v,{value:f+1,children:f+1}))}),n.touched.month&&n.errors.month&&e.jsx(k,{children:n.errors.month})]})}),e.jsx(D,{item:!0,xs:6,children:e.jsxs(A,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(n.touched.type&&n.errors.type),children:[e.jsx(P,{id:"batiment-id",children:r(s.salaire.year)}),e.jsxs(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:n.handleBlur,fullWidth:!0,name:"year",onChange:n.handleChange,value:n.values.year,label:r(s.salaire.year),children:[e.jsx(v,{value:o.getFullYear()-1,children:o.getFullYear()-1}),e.jsx(v,{value:o.getFullYear(),children:o.getFullYear()}),e.jsx(v,{value:o.getFullYear()+1,children:o.getFullYear()+1}),e.jsx(v,{value:o.getFullYear()+2,children:o.getFullYear()+2})]}),n.touched.year&&n.errors.year&&e.jsx(k,{children:n.errors.year})]})})]}),e.jsx(Y,{fullWidth:!0,size:"large",sx:{mt:2},type:"submit",variant:"contained",children:r(s.global.modifier)})]})]})}),e.jsx(be,{confirmed:p})]})}const ms={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function ps({employee:u}){const l=U(),{t:r,i18n:m}=T(),{isModalAdd:h}=I(p=>p.salaire),a=new Date,o=ce({amount:X().required(r(s.paiment.amountRequired)),employee:X().required(r(s.salaire.employeeRequired))}),t=de({initialValues:{amount:0,observation:null,employee:"",date:new Date,month:null,year:null},validationSchema:o,onSubmit:async(p,{resetForm:i,setErrors:f})=>{const F={...p};F.date=ie(p.date).format("YYYY-MM-DD"),V.post("/employeewage/add/",F).then(O=>{l(d.actions.addSalaire(O.data)),l(d.actions.openCloseModalAdd()),l(d.actions.openCloseConfirm()),_.success(r(s.salaire.toastAddSuccess)),i()}).catch(O=>{console.log(O),l(d.actions.openCloseConfirm()),_.error(r(s.global.toastError))})}}),n=async p=>{p.preventDefault();const i=await t.validateForm();Object.keys(i).length===0?l(d.actions.openCloseConfirm()):await t.submitForm()},b=()=>{t.handleSubmit()};return e.jsxs(e.Fragment,{children:[e.jsx(H,{open:h,onClose:()=>l(d.actions.openCloseModalAdd()),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(Q,{sx:ms,children:[e.jsxs(N,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"20px"},children:[e.jsx(Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:r(s.salaire.addTitle)}),e.jsx("div",{className:"cursor-pointer",onClick:()=>l(d.actions.openCloseModalAdd()),children:e.jsx(ee,{})})]}),e.jsxs("form",{noValidate:!0,onSubmit:p=>n(p),children:[e.jsx(z,{id:"outlined-basic",label:r(s.paiment.amount),variant:"outlined",onBlur:t.handleBlur,fullWidth:!0,type:"number",name:"amount",onChange:t.handleChange,value:t.values.amount,error:!!(t.touched.amount&&t.errors.amount),helperText:t.touched.amount&&t.errors.amount,style:{marginBottom:"15px"}}),e.jsx(z,{id:"outlined-basic",label:r(s.salaire.observation),variant:"outlined",onBlur:t.handleBlur,fullWidth:!0,multiline:!0,maxRows:4,name:"observation",onChange:t.handleChange,value:t.values.observation,error:!!(t.touched.observation&&t.errors.observation),helperText:t.touched.observation&&t.errors.observation,style:{marginBottom:"15px"}}),e.jsxs(A,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(t.touched.employee&&t.errors.employee),children:[e.jsx(P,{id:"batiment-id",error:!!(t.touched.employee&&t.errors.employee),children:r(s.employee.title)}),e.jsx(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:t.handleBlur,fullWidth:!0,name:"employee",onChange:t.handleChange,value:t.values.employee,label:r(s.employee.title),error:!!(t.touched.employee&&t.errors.employee),children:u.length>0?u.map(p=>e.jsxs(v,{value:p.id,children:[p.first_name," ",p.last_name]})):e.jsx(v,{children:r(s.batiment.nothingToDisplay)})}),t.touched.employee&&t.errors.employee&&e.jsx(k,{children:t.errors.employee})]}),e.jsx(J,{label:r(s.entrer.date),value:t.values.date,onChange:p=>t.setFieldValue("date",p),onBlur:t.handleBlur,name:"date",sx:{width:"100%"}}),e.jsx(D,{xs:12,mt:.8,mb:.9,children:e.jsx(P,{children:r(s.salaire.periode)})}),e.jsxs(D,{container:!0,spacing:2,children:[e.jsx(D,{item:!0,xs:6,children:e.jsxs(A,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(t.touched.type&&t.errors.type),children:[e.jsx(P,{id:"batiment-id",children:r(s.salaire.month)}),e.jsx(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:t.handleBlur,fullWidth:!0,name:"month",onChange:t.handleChange,value:t.values.month,label:r(s.salaire.month),children:[...Array(12)].map((p,i)=>e.jsx(v,{value:i+1,children:i+1}))}),t.touched.month&&t.errors.month&&e.jsx(k,{children:t.errors.month})]})}),e.jsx(D,{item:!0,xs:6,children:e.jsxs(A,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(t.touched.type&&t.errors.type),children:[e.jsx(P,{id:"batiment-id",children:r(s.salaire.year)}),e.jsxs(M,{labelId:"batiment-id",id:"demo-simple-select",onBlur:t.handleBlur,fullWidth:!0,name:"year",onChange:t.handleChange,value:t.values.year,label:r(s.salaire.year),children:[e.jsx(v,{value:a.getFullYear()-1,children:a.getFullYear()-1}),e.jsx(v,{value:a.getFullYear(),children:a.getFullYear()}),e.jsx(v,{value:a.getFullYear()+1,children:a.getFullYear()+1}),e.jsx(v,{value:a.getFullYear()+2,children:a.getFullYear()+2})]}),t.touched.year&&t.errors.year&&e.jsx(k,{children:t.errors.year})]})})]}),e.jsx(Y,{fullWidth:!0,size:"large",sx:{mt:2},type:"submit",variant:"contained",children:r(s.global.ajouter)})]})]})}),e.jsx(be,{confirmed:b})]})}function us(){const{currentData:u,isModalDelete:l}=I(o=>o.salaire),r=U(),{t:m,i18n:h}=T(),a=()=>{V.delete(`/employeewage/delete/${u.id}`).then(o=>{r(d.actions.deleteSalaire()),r(d.actions.openCloseModalDelete()),_.success(m(s.salaire.toastDeleteSuccess))}).catch(o=>{r(d.actions.openCloseModalDelete()),_.error(m(s.global.toastError))})};return e.jsx(H,{open:l,onClose:()=>r(d.actions.openCloseModalDelete()),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:e.jsx(De,{title:m(s.salaire.deletetitle),message:m(s.salaire.deleteMessage),deleteFn:a,cancel:()=>r(d.actions.openCloseModalDelete())})})}function hs(){const{currentData:u,isModalDeleteProof:l}=I(o=>o.salaire),r=U(),{t:m,i18n:h}=T(),a=()=>{V.delete(`/employeewage/proof/delete/${u.idFile}`).then(o=>{r(d.actions.deleteSalaireProof()),r(d.actions.openCloseConfirmDeleteProof()),_.success(m(s.global.toastSuccessDeleteFile))}).catch(o=>{console.log(o),r(d.actions.openCloseConfirmDeleteProof()),_.error(m(s.global.toastError))})};return e.jsx(H,{open:l,onClose:()=>r(d.actions.openCloseConfirmDeleteProof()),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:e.jsx(De,{title:m(s.paiment.deleteTitleFile),message:m(s.paiment.deleteDescriptionFile),deleteFn:a,cancel:()=>r(d.actions.openCloseConfirmDeleteProof())})})}function xs(){const{isModalAdd:u,isModalUpdate:l}=I(m=>m.salaire),r=oe("employee",le.fetchOeuvreList);return e.jsxs(Q,{component:"main",sx:{flexGrow:1,py:8},children:[e.jsx(je,{children:e.jsx(is,{})}),u&&e.jsx(ps,{employee:r.data}),l&&e.jsx(cs,{employee:r.data}),e.jsx(us,{}),e.jsx(hs,{})]})}function Ms(){return e.jsx(e.Fragment,{children:e.jsx(je,{children:e.jsx(xs,{})})})}export{Ms as default};
