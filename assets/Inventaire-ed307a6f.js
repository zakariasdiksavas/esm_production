import{n as ae,o as se,s as q,q as te,_ as B,r as j,x as ie,y as oe,bq as fe,br as be,T as O,j as e,z as K,A as le,c as je,bs as Te,t as Ie,bt as De,bu as Me,bv as _e,bw as $e,a2 as U,d as W,B as Fe,a3 as Ne,l as o,a1 as he,V as ne,bx as x,h as Y,ab as M,ac as $,ad as F,ae as T,a as J,a6 as H,a7 as de,F as z,k as ve,Y as _,S as qe}from"./index-b9aeea20.js";import{e as We,T as Ee,a as Le,b as re,c as R,d as Ae,f as ze,g as Ge,G as b,u as Q,S as A,h as Z,B as ce,E as Ce}from"./moment-8bb476e3.js";import{E as Ue,P as Ve,M as Oe}from"./ModalDelete-e666945f.js";import{T as Ye,C as ye}from"./TableRowsLoader-c4300d5c.js";import{A as Je}from"./AlertError-9fdceddd.js";import{D as He}from"./DeleteOutlineOutlined-7644538f.js";import{u as ue,c as me,C as Se,b as Qe,d as N}from"./formik.esm-799b94e8.js";import{A as Ze,a as Ke,F as Xe,b as et,m as G}from"./fr-3088b82b.js";import{E as tt}from"./ExpandMore-6e3ae782.js";import{C as ot}from"./Container-7ef0f39f.js";import{M as we}from"./ModalConfirm-37aae7aa.js";import{S as rt}from"./SwitchBase-3bfb2aa6.js";import{D as Re}from"./DateTimePicker-e1425ffd.js";import"./Tabs-029752cf.js";function nt(r){return se("MuiFormControlLabel",r)}const at=ae("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),V=at,st=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],it=r=>{const{classes:n,disabled:d,labelPlacement:a,error:t,required:p}=r,m={root:["root",d&&"disabled",`labelPlacement${te(a)}`,t&&"error",p&&"required"],label:["label",d&&"disabled"],asterisk:["asterisk",t&&"error"]};return le(m,nt,n)},lt=q("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(r,n)=>{const{ownerState:d}=r;return[{[`& .${V.label}`]:n.label},n.root,n[`labelPlacement${te(d.labelPlacement)}`]]}})(({theme:r,ownerState:n})=>B({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${V.disabled}`]:{cursor:"default"}},n.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},n.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},n.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${V.label}`]:{[`&.${V.disabled}`]:{color:(r.vars||r).palette.text.disabled}}})),dt=q("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(r,n)=>n.asterisk})(({theme:r})=>({[`&.${V.error}`]:{color:(r.vars||r).palette.error.main}})),ct=j.forwardRef(function(n,d){var a,t;const p=ie({props:n,name:"MuiFormControlLabel"}),{className:m,componentsProps:u={},control:l,disabled:S,disableTypography:f,label:v,labelPlacement:s="end",required:i,slotProps:w={}}=p,h=oe(p,st),c=fe(),I=(a=S??l.props.disabled)!=null?a:c==null?void 0:c.disabled,C=i??l.props.required,y={disabled:I,required:C};["checked","name","onChange","value","inputRef"].forEach(L=>{typeof l.props[L]>"u"&&typeof p[L]<"u"&&(y[L]=p[L])});const D=be({props:p,muiFormControl:c,states:["error"]}),E=B({},p,{disabled:I,labelPlacement:s,required:C,error:D.error}),g=it(E),k=(t=w.typography)!=null?t:u.typography;let P=v;return P!=null&&P.type!==O&&!f&&(P=e.jsx(O,B({component:"span"},k,{className:K(g.label,k==null?void 0:k.className),children:P}))),e.jsxs(lt,B({className:K(g.root,m),ownerState:E,ref:d},h,{children:[j.cloneElement(l,y),P,C&&e.jsxs(dt,{ownerState:E,"aria-hidden":!0,className:g.asterisk,children:[" ","*"]})]}))}),X=ct;function ut(r){return se("MuiFormGroup",r)}ae("MuiFormGroup",["root","row","error"]);const mt=["className","row"],ht=r=>{const{classes:n,row:d,error:a}=r;return le({root:["root",d&&"row",a&&"error"]},ut,n)},pt=q("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(r,n)=>{const{ownerState:d}=r;return[n.root,d.row&&n.row]}})(({ownerState:r})=>B({display:"flex",flexDirection:"column",flexWrap:"wrap"},r.row&&{flexDirection:"row"})),xt=j.forwardRef(function(n,d){const a=ie({props:n,name:"MuiFormGroup"}),{className:t,row:p=!1}=a,m=oe(a,mt),u=fe(),l=be({props:a,muiFormControl:u,states:["error"]}),S=B({},a,{row:p,error:l.error}),f=ht(S);return e.jsx(pt,B({className:K(f.root,t),ownerState:S,ref:d},m))}),gt=xt,ft=je(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),bt=je(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),jt=q("span")({position:"relative",display:"flex"}),vt=q(ft)({transform:"scale(1)"}),Ct=q(bt)(({theme:r,ownerState:n})=>B({left:0,position:"absolute",transform:"scale(0)",transition:r.transitions.create("transform",{easing:r.transitions.easing.easeIn,duration:r.transitions.duration.shortest})},n.checked&&{transform:"scale(1)",transition:r.transitions.create("transform",{easing:r.transitions.easing.easeOut,duration:r.transitions.duration.shortest})}));function Be(r){const{checked:n=!1,classes:d={},fontSize:a}=r,t=B({},r,{checked:n});return e.jsxs(jt,{className:d.root,ownerState:t,children:[e.jsx(vt,{fontSize:a,className:d.background,ownerState:t}),e.jsx(Ct,{fontSize:a,className:d.dot,ownerState:t})]})}const yt=j.createContext(void 0),ke=yt;function St(){return j.useContext(ke)}function wt(r){return se("MuiRadio",r)}const Rt=ae("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),pe=Rt,Bt=["checked","checkedIcon","color","icon","name","onChange","size","className"],kt=r=>{const{classes:n,color:d}=r,a={root:["root",`color${te(d)}`]};return B({},n,le(a,wt,n))},Pt=q(rt,{shouldForwardProp:r=>Te(r)||r==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(r,n)=>{const{ownerState:d}=r;return[n.root,n[`color${te(d.color)}`]]}})(({theme:r,ownerState:n})=>B({color:(r.vars||r).palette.text.secondary},!n.disableRipple&&{"&:hover":{backgroundColor:r.vars?`rgba(${n.color==="default"?r.vars.palette.action.activeChannel:r.vars.palette[n.color].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:Ie(n.color==="default"?r.palette.action.active:r.palette[n.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},n.color!=="default"&&{[`&.${pe.checked}`]:{color:(r.vars||r).palette[n.color].main}},{[`&.${pe.disabled}`]:{color:(r.vars||r).palette.action.disabled}}));function Tt(r,n){return typeof n=="object"&&n!==null?r===n:String(r)===String(n)}const xe=e.jsx(Be,{checked:!0}),ge=e.jsx(Be,{}),It=j.forwardRef(function(n,d){var a,t;const p=ie({props:n,name:"MuiRadio"}),{checked:m,checkedIcon:u=xe,color:l="primary",icon:S=ge,name:f,onChange:v,size:s="medium",className:i}=p,w=oe(p,Bt),h=B({},p,{color:l,size:s}),c=kt(h),I=St();let C=m;const y=De(v,I&&I.onChange);let D=f;return I&&(typeof C>"u"&&(C=Tt(I.value,p.value)),typeof D>"u"&&(D=I.name)),e.jsx(Pt,B({type:"radio",icon:j.cloneElement(S,{fontSize:(a=ge.props.fontSize)!=null?a:s}),checkedIcon:j.cloneElement(u,{fontSize:(t=xe.props.fontSize)!=null?t:s}),ownerState:h,classes:c,name:D,checked:C,onChange:y,ref:d,className:K(c.root,i)},w))}),ee=It,Dt=["actions","children","defaultValue","name","onChange","value"],Mt=j.forwardRef(function(n,d){const{actions:a,children:t,defaultValue:p,name:m,onChange:u,value:l}=n,S=oe(n,Dt),f=j.useRef(null),[v,s]=Me({controlled:l,default:p,name:"RadioGroup"});j.useImperativeHandle(a,()=>({focus:()=>{let c=f.current.querySelector("input:not(:disabled):checked");c||(c=f.current.querySelector("input:not(:disabled)")),c&&c.focus()}}),[]);const i=_e(d,f),w=$e(m),h=j.useMemo(()=>({name:w,onChange(c){s(c.target.value),u&&u(c,c.target.value)},value:v}),[w,u,s,v]);return e.jsx(ke.Provider,{value:h,children:e.jsx(gt,B({role:"radiogroup",ref:i},S,{children:t}))})}),Pe=Mt,_t=j.memo(r=>{const n=JSON.parse(sessionStorage.getItem("user")),d=U();let{count:a=0,items:t=[],onDeselectAll:p,onDeselectOne:m,onSelectAll:u,onSelectOne:l,selected:S=[],isLoading:f,isError:v}=r;const[s,i]=j.useState(0),[w,h]=j.useState(25),{t:c,i18n:I}=W(),C=(g,k)=>{let P=t.filter(L=>L.id==g);d(x.actions.setCurrentData(P[0])),d(k?x.actions.openCloseModalUpdate():x.actions.openCloseModalDelete())},y=(g,k)=>{i(k)},D=g=>{h(parseInt(g.target.value,10)),i(0)},E=t==null?void 0:t.slice(s*w,s*w+w);return e.jsxs(Fe,{sx:{position:"relative"},children:[e.jsx(We,{component:Ne,children:e.jsxs(Ee,{sx:{minWidth:700},children:[e.jsx(Le,{children:e.jsxs(re,{children:[e.jsx(R,{children:n!=null&&n.is_eleveur?c(o.batiment.Nom):c(o.fournisseur.Nom)}),e.jsx(R,{children:c(o.magazin.title)}),e.jsx(R,{children:c(o.sortie.eggType)}),e.jsx(R,{children:c(o.entrer.quantity)}),e.jsx(R,{children:c(o.entrer.date)}),e.jsx(R,{children:c(o.entrer.temps)}),e.jsx(R,{})]})}),f?e.jsx(Ye,{rowsNum:10}):e.jsx(Ae,{children:E.length>0?E.map(g=>{let k=new Date(g.date),P={year:k.getFullYear(),month:`${k.getMonth()+1}`,day:`${k.getDate()}`};return e.jsxs(re,{hover:!0,children:[e.jsx(R,{children:g.eggsource_name}),e.jsx(R,{children:g.warehouse_name}),e.jsx(R,{children:g.eggclass_name}),e.jsxs(R,{sx:{direction:"initial",whiteSpace:"nowrap"},children:[g.is_positive?"+":"-",g.value.toLocaleString("en-US").replaceAll(","," ")]}),e.jsxs(R,{children:[P.day.padStart(2,0),"/",P.month.padStart(2,0),"/",P.year]}),e.jsx(R,{children:g.time.substring(0,5)}),e.jsxs(R,{children:[e.jsx(he,{color:"warning",onClick:()=>C(g.id,!0),children:e.jsx(ne,{children:e.jsx(Ue,{})})}),e.jsx(he,{color:"error",onClick:()=>C(g.id,!1),children:e.jsx(ne,{children:e.jsx(He,{})})})]})]},g.id)}):e.jsx(re,{children:e.jsx(R,{colSpan:5,sx:{textAlign:"center"},children:c(o.batiment.nothingToDisplay)})})})]})}),e.jsx(ze,{component:"div",count:a,onPageChange:y,onRowsPerPageChange:D,page:s,rowsPerPage:w,rowsPerPageOptions:[5,10,25],labelRowsPerPage:c(o.batiment.Lignes),labelDisplayedRows:({from:g,to:k,count:P})=>`${g}–${k} ${c(o.batiment.sur)} ${P}`}),v&&e.jsx(Je,{})]})});function $t({batiment:r,magazin:n,eggType:d}){Ge.locale("fr");const{t:a,i18n:t}=W(),p=U(),m=JSON.parse(sessionStorage.getItem("user")),u=ue({initialValues:{warehouse:"",eggsource:"",classe:""},validationSchema:me({}),onSubmit:async(l,{resetForm:S,setErrors:f})=>{let v="";for(let s in l)v==""?v+=`?${s}=${l[s]}`:v+=`&${s}=${l[s]}`;Y.get("/inventory/list/"+v).then(s=>{p(x.actions.fetchInventaire(s.data))})},onReset:()=>{Y.get("/inventory/list/").then(l=>{p(x.actions.fetchInventaire(l.data))})}});return e.jsxs(Ze,{defaultExpanded:!0,children:[e.jsx(Ke,{expandIcon:e.jsx(tt,{}),"aria-controls":"panel1-content",id:"panel1-header",children:e.jsxs("h3",{className:"font-bold text-lg",children:[e.jsx(Xe,{}),a(o.global.filter)]})}),e.jsx(et,{children:e.jsx(Se,{children:e.jsx(Qe,{children:e.jsx("form",{noValidate:!0,onSubmit:u.handleSubmit,onReset:u.handleReset,children:e.jsxs(b,{container:!0,alignItems:"center",gap:2,children:[e.jsx(b,{item:!0,xs:12,md:2,sm:12,children:e.jsxs(M,{fullWidth:!0,children:[e.jsx($,{id:"batiment-id",children:m!=null&&m.is_eleveur?a(o.batiment.Nom):a(o.fournisseur.Nom)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:u.handleBlur,fullWidth:!0,name:"eggsource",onChange:u.handleChange,value:u.values.eggsource,label:m!=null&&m.is_eleveur?a(o.batiment.Nom):a(o.fournisseur.Nom),children:r==null?void 0:r.map(l=>e.jsxs(T,{value:l.id,children:[l.name,"  ",l.last_name]}))})]})}),e.jsx(b,{items:!0,xs:12,md:2,sm:12,children:e.jsxs(M,{fullWidth:!0,children:[e.jsx($,{id:"batiment-id",children:a(o.magazin.Nom)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:u.handleBlur,fullWidth:!0,name:"warehouse",onChange:u.handleChange,value:u.values.warehouse,label:a(o.batiment.Nom),children:n==null?void 0:n.map(l=>e.jsx(T,{value:l.id,children:l.name}))})]})}),e.jsx(b,{items:!0,xs:12,md:2,sm:12,children:e.jsxs(M,{fullWidth:!0,children:[e.jsx($,{id:"batiment-id",children:a(o.magazin.Nom)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:u.handleBlur,fullWidth:!0,name:"classe",onChange:u.handleChange,value:u.values.classe,label:a(o.sortie.eggType),children:d==null?void 0:d.map(l=>e.jsx(T,{value:l.id,children:l.value}))})]})}),e.jsxs(b,{item:!0,container:!0,xs:12,md:2,sm:12,gap:2,sx:{alignContent:"center",justifyContent:"end"},children:[e.jsx(b,{items:!0,children:e.jsx(J,{variant:"contained",type:"reset",children:a(o.global.reset)})}),e.jsx(b,{items:!0,children:e.jsx(J,{type:"submit",variant:"contained",children:a(o.global.filter)})})]})]})})})})})]})}function Ft({magazin:r,batiment:n,eggType:d}){const a=U(),{t,i18n:p}=W(),{inventaire:m}=H(l=>l.inventaire),u=Q("inventaire",Z.getInventaire);return j.useEffect(()=>{u.status=="success"&&a(x.actions.fetchInventaire(u.data))},[u.status]),e.jsx(ot,{maxWidth:"xl",children:e.jsxs(A,{spacing:4,children:[e.jsxs(A,{direction:"row",justifyContent:"space-between",spacing:4,children:[e.jsx(A,{spacing:1,children:e.jsx(O,{variant:"h4",children:t(o.inventaire.title)})}),e.jsx(A,{alignItems:"center",direction:"row",spacing:3,children:e.jsx(J,{startIcon:e.jsx(ne,{children:e.jsx(Ve,{})}),variant:"contained",onClick:()=>a(x.actions.openCloseModalAdd()),children:t(o.global.ajouter)})})]}),e.jsxs(Se,{children:[e.jsx($t,{batiment:n,magazin:r,eggType:d}),e.jsx(_t,{items:m,isLoading:u.isLoading,count:m.length,rowsPerPage:25,isError:u.isError})]})]})})}const Nt={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function qt({batiment:r,magazin:n,eggType:d}){G.locale("fr");const a=U(),{t,i18n:p}=W(),[m,u]=j.useState(new Date),l=JSON.parse(sessionStorage.getItem("user")),{isModalUpdate:S,currentData:f,isConfirm:v}=H(c=>c.inventaire),s=me({eggsource:N().required(l!=null&&l.is_eleveur?t(o.entrer.batimentRequired):t(o.entrer.fournisseurRequired)),warehouse:N().required(t(o.entrer.magazinRequired)),option:N().required(t(o.sortie.optionRequired)),value:N().required(t(o.sortie.quantityRequired))}),i=ue({initialValues:{eggsource:"",warehouse:"",option:"",value:"",is_positive:"true",dateTime:""},validationSchema:s,onSubmit:async(c,{resetForm:I,setErrors:C})=>{let y={...c};y.date=G(m).format("YYYY-MM-DD"),y.time=G(m).format("LT"),y.is_positive=y.is_positive=="true",Y.put("/inventory/update/",y).then(D=>{a(x.actions.editInventaire(D.data)),a(x.actions.openCloseModalUpdate()),a(x.actions.openCloseConfirm()),_.success(t(o.inventaire.toastUpdateSuccess)),I()}).catch(D=>{if(a(x.actions.openCloseConfirm()),D.response.data==2){_.error(t(o.sortie.outOfStock));return}else D.response.data==1?_.error(t(o.sortie.noStockExist)):_.error(t(o.sortie.toastError))})}}),w=c=>{c.preventDefault(),a(x.actions.openCloseConfirm())},h=()=>{i.handleSubmit()};return j.useEffect(()=>{i.setValues(f),f.is_positive?i.setFieldValue("is_positive","true"):i.setFieldValue("is_positive","false"),u(new Date(`${f.date}T${f.time}`)),i.setFieldValue("dateTime",new Date,!1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(de,{open:S,onClose:()=>a(x.actions.openCloseModalUpdate()),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(ce,{sx:Nt,children:[e.jsxs(A,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"20px"},children:[e.jsx(O,{id:"modal-modal-title",variant:"h6",component:"h2",children:t(o.inventaire.update)}),e.jsx("div",{className:"cursor-pointer",onClick:()=>a(x.actions.openCloseModalUpdate()),children:e.jsx(ye,{})})]}),e.jsxs("form",{noValidate:!0,onSubmit:c=>w(c),children:[e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(M,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(i.touched.eggsource&&i.errors.eggsource),children:[e.jsx($,{id:"batiment-id",children:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:i.handleBlur,fullWidth:!0,name:"eggsource",onChange:i.handleChange,value:i.values.eggsource,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:r.length>0?r.map(c=>e.jsx(T,{value:c.id,children:c.name})):e.jsx(T,{children:t(o.batiment.nothingToDisplay)})}),i.touched.eggsource&&i.errors.eggsource&&e.jsx(z,{children:i.errors.eggsource})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(M,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(i.touched.warehouse&&i.errors.warehouse),children:[e.jsx($,{id:"batiment-id",children:t(o.magazin.title)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:i.handleBlur,fullWidth:!0,name:"warehouse",onChange:i.handleChange,value:i.values.warehouse,label:t(o.magazin.title),children:n.length>0?n.map(c=>e.jsx(T,{value:c.id,children:c.name})):e.jsx(T,{children:t(o.batiment.nothingToDisplay)})}),i.touched.warehouse&&i.errors.warehouse&&e.jsx(z,{children:i.errors.warehouse})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(M,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(i.touched.option&&i.errors.option),children:[e.jsx($,{id:"batiment-id",children:t(o.sortie.eggType)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:i.handleBlur,fullWidth:!0,name:"option",onChange:i.handleChange,value:i.values.option,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:d.map(c=>e.jsx(T,{value:c.id,children:c.value}))}),i.touched.option&&i.errors.option&&e.jsx(z,{children:i.errors.option})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsx(Re,{id:"outlined-basic",label:t(o.entrer.temps)+" "+t(o.entrer.date),variant:"outlined",onBlur:i.handleBlur,fullWidth:!0,name:"dateTime",value:m,onChange:c=>{i.setFieldValue("dateTime",c,!0),u(c)},slotProps:{textField:{variant:"outlined",error:!!(i.touched.dateTime&&i.errors.dateTime),helperText:!!(i.touched.dateTime&&i.errors.dateTime)}},sx:{marginBottom:"15px",marginTop:"5px",width:"100%"}})}),e.jsxs(b,{item:!0,xs:12,children:[e.jsx(ve,{id:"outlined-basic",label:t(o.entrer.quantity),variant:"outlined",fullWidth:!0,type:"number",onBlur:i.handleBlur,onChange:i.handleChange,value:i.values.value,error:!!(i.touched.value&&i.errors.value),helperText:i.touched.value&&i.errors.value,name:"value",style:{marginBottom:"1px"}}),e.jsx(M,{children:e.jsxs(Pe,{"aria-labelledby":"demo-radio-buttons-group-label",value:i.values.is_positive,onBlur:i.handleBlur,onChange:i.handleChange,name:"is_positive",children:[e.jsx(X,{name:"is_positive",value:"true",control:e.jsx(ee,{}),label:t(o.inventaire.increaseStock)}),e.jsx(X,{name:"is_positive",value:"false",control:e.jsx(ee,{}),label:t(o.inventaire.decreaseStock)})]})})]})]}),e.jsx(J,{fullWidth:!0,size:"large",sx:{mt:2},type:"submit",variant:"contained",children:t(o.global.modifier)})]})]})}),e.jsx(we,{confirmed:h,cancel:()=>a(x.actions.openCloseConfirm()),isConfirm:v})]})}const Wt={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function Et({batiment:r,magazin:n,eggType:d}){G.locale("fr");const a=U(),{t,i18n:p}=W(),[m,u]=j.useState(new Date),l=JSON.parse(sessionStorage.getItem("user")),{isModalAdd:S,isConfirm:f}=H(h=>h.inventaire),v=me({eggsource:N().required(l!=null&&l.is_eleveur?t(o.entrer.batimentRequired):t(o.entrer.fournisseurRequired)),warehouse:N().required(t(o.entrer.magazinRequired)),option:N().required(t(o.sortie.optionRequired)),value:N().required(t(o.sortie.quantityRequired))}),s=ue({initialValues:{eggsource:"",warehouse:"",option:"",value:"",is_positive:"true",dateTime:""},validationSchema:v,onSubmit:async(h,{resetForm:c,setErrors:I})=>{let C={...h};C.date=G(m).format("YYYY-MM-DD"),C.time=G(m).format("LT"),C.is_positive=C.is_positive=="true",Y.post("/inventory/add/",C).then(y=>{a(x.actions.addInventaire(y.data)),a(x.actions.openCloseModalAdd()),a(x.actions.openCloseConfirm()),_.success(t(o.inventaire.toastAddSuccess)),c()}).catch(y=>{if(a(x.actions.openCloseConfirm()),y.response.data==2){_.error(t(o.sortie.outOfStock));return}else y.response.data==1?_.error(t(o.sortie.noStockExist)):_.error(t(o.sortie.toastError))})}}),i=h=>{h.preventDefault(),a(x.actions.openCloseConfirm())},w=()=>{s.handleSubmit()};return e.jsxs(e.Fragment,{children:[e.jsx(de,{open:S,onClose:()=>a(x.actions.openCloseModalAdd()),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(ce,{sx:Wt,children:[e.jsxs(A,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"20px"},children:[e.jsx(O,{id:"modal-modal-title",variant:"h6",component:"h2",children:t(o.inventaire.add)}),e.jsx("div",{className:"cursor-pointer",onClick:()=>a(x.actions.openCloseModalAdd()),children:e.jsx(ye,{})})]}),e.jsxs("form",{noValidate:!0,onSubmit:h=>i(h),children:[e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(M,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(s.touched.eggsource&&s.errors.eggsource),children:[e.jsx($,{id:"batiment-id",children:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:s.handleBlur,fullWidth:!0,name:"eggsource",onChange:s.handleChange,value:s.values.eggsource,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:r.length>0?r.map(h=>e.jsx(T,{value:h.id,children:h.name})):e.jsx(T,{children:t(o.batiment.nothingToDisplay)})}),s.touched.eggsource&&s.errors.eggsource&&e.jsx(z,{children:s.errors.eggsource})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(M,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(s.touched.warehouse&&s.errors.warehouse),children:[e.jsx($,{id:"batiment-id",children:t(o.magazin.title)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:s.handleBlur,fullWidth:!0,name:"warehouse",onChange:s.handleChange,value:s.values.warehouse,label:t(o.magazin.title),children:n.length>0?n.map(h=>e.jsx(T,{value:h.id,children:h.name})):e.jsx(T,{children:t(o.batiment.nothingToDisplay)})}),s.touched.warehouse&&s.errors.warehouse&&e.jsx(z,{children:s.errors.warehouse})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsxs(M,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(s.touched.option&&s.errors.option),children:[e.jsx($,{id:"batiment-id",children:t(o.sortie.eggType)}),e.jsx(F,{labelId:"batiment-id",id:"demo-simple-select",onBlur:s.handleBlur,fullWidth:!0,name:"option",onChange:s.handleChange,value:s.values.option,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:d.map(h=>e.jsx(T,{value:h.id,children:h.value}))}),s.touched.option&&s.errors.option&&e.jsx(z,{children:s.errors.option})]})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsx(Re,{id:"outlined-basic",label:t(o.entrer.temps)+" "+t(o.entrer.date),variant:"outlined",onBlur:s.handleBlur,fullWidth:!0,name:"dateTime",value:m,onChange:h=>{s.setFieldValue("dateTime",h,!0),u(h)},slotProps:{textField:{variant:"outlined",error:!!(s.touched.dateTime&&s.errors.dateTime),helperText:!!(s.touched.dateTime&&s.errors.dateTime)}},sx:{marginBottom:"15px",marginTop:"5px",width:"100%"}})}),e.jsxs(b,{item:!0,xs:12,children:[e.jsx(ve,{id:"outlined-basic",label:t(o.entrer.quantity),variant:"outlined",fullWidth:!0,type:"number",onBlur:s.handleBlur,onChange:s.handleChange,value:s.values.value,error:!!(s.touched.value&&s.errors.value),helperText:s.touched.value&&s.errors.value,name:"value",style:{marginBottom:"1px"}}),e.jsx(M,{children:e.jsxs(Pe,{"aria-labelledby":"demo-radio-buttons-group-label",value:s.values.is_positive,onBlur:s.handleBlur,onChange:s.handleChange,name:"is_positive",children:[e.jsx(X,{name:"is_positive",value:"true",control:e.jsx(ee,{}),label:t(o.inventaire.increaseStock)}),e.jsx(X,{name:"is_positive",value:"false",control:e.jsx(ee,{}),label:t(o.inventaire.decreaseStock)})]})})]})]}),e.jsx(J,{fullWidth:!0,size:"large",sx:{mt:2},type:"submit",variant:"contained",children:t(o.global.ajouter)})]})]})}),e.jsx(we,{confirmed:w,cancel:()=>a(x.actions.openCloseConfirm()),isConfirm:f})]})}function Lt(){const{currentData:r,isModalDelete:n}=H(m=>m.inventaire),d=U(),{t:a,i18n:t}=W();JSON.parse(sessionStorage.getItem("user"));const p=()=>{Y.delete(`/inventory/delete/${r.id}`).then(m=>{d(x.actions.deleteInventaire()),d(x.actions.openCloseModalDelete()),_.success(a(o.inventaire.toastDeleteSuccess))}).catch(m=>{d(x.actions.openCloseModalDelete()),_.error(a(o.global.toastError))})};return e.jsx(de,{open:n,onClose:()=>d(x.actions.openCloseModalDelete()),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:e.jsx(Oe,{title:a(o.inventaire.deleteTitle),message:a(o.inventaire.deleteDescription),deleteFn:p,cancel:()=>d(x.actions.openCloseModalDelete())})})}function At(){const{isModalAdd:r,isModalUpdate:n}=H(p=>p.inventaire),d=Q("batiment",Z.getBatimentSelect),a=Q("magazin",Z.getWarehouseSelect),t=Q("eggType",Z.getClass);return e.jsxs(ce,{component:"main",sx:{flexGrow:1,py:8},children:[e.jsx(Ce,{children:e.jsx(Ft,{magazin:a==null?void 0:a.data,batiment:d==null?void 0:d.data,eggType:t==null?void 0:t.data})}),r&&e.jsx(Et,{batiment:d.data,magazin:a.data,eggType:t.data}),n&&e.jsx(qt,{batiment:d.data,magazin:a.data,eggType:t.data}),e.jsx(Lt,{})]})}function oo(){const{t:r,i18n:n}=W();return e.jsxs(e.Fragment,{children:[e.jsx(qe,{title:`ESM | ${r(o.nav.inventaire)}`}),e.jsx(Ce,{children:e.jsx(At,{})})]})}export{oo as default};
