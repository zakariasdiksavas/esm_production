import{n as se,o as ie,s as L,q as te,_ as R,r as C,x as le,y as oe,bo as fe,bp as be,T as H,j as e,z as K,A as de,c as je,bq as Pe,t as Ie,br as De,bs as Me,bt as Fe,bu as $e,a2 as z,d as N,B as _e,a3 as Ne,l as o,a1 as he,V as ae,bv as g,h as Q,ab as D,ac as F,ad as $,ae as P,a as Z,a6 as Y,a7 as re,F as V,k as ve,Y as M,S as qe}from"./index-bffffd5d.js";import{e as We,T as Ee,a as Le,b as ne,c as w,d as ze,f as Ae,g as Ge,G as v,u as W,S as U,h as E,B as ce,E as Ce}from"./moment-c1228ca8.js";import{E as Ue,P as Ve,M as Oe}from"./ModalDelete-6c83eee3.js";import{T as Ye,C as ye}from"./TableRowsLoader-1fe09bf9.js";import{A as Je}from"./AlertError-b5da0392.js";import{D as He}from"./DeleteOutlineOutlined-6b34994d.js";import{u as ue,c as me,C as Se,b as Qe,d as _}from"./formik.esm-51017e53.js";import{A as Ze,a as Ke,F as Xe,b as et}from"./fr-a1d10d63.js";import{E as tt}from"./ExpandMore-933c5590.js";import{C as ot}from"./Container-76ca21d5.js";import{M as rt}from"./ModalConfirm-f66dfd05.js";import{m as O}from"./moment-52bdcb4a.js";import{S as nt}from"./SwitchBase-9719708d.js";import{D as we}from"./DateTimePicker-ccc7cb69.js";import"./Tabs-12df9ed9.js";function at(r){return ie("MuiFormControlLabel",r)}const st=se("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),J=st,it=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],lt=r=>{const{classes:n,disabled:d,labelPlacement:s,error:t,required:h}=r,c={root:["root",d&&"disabled",`labelPlacement${te(s)}`,t&&"error",h&&"required"],label:["label",d&&"disabled"],asterisk:["asterisk",t&&"error"]};return de(c,at,n)},dt=L("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(r,n)=>{const{ownerState:d}=r;return[{[`& .${J.label}`]:n.label},n.root,n[`labelPlacement${te(d.labelPlacement)}`]]}})(({theme:r,ownerState:n})=>R({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${J.disabled}`]:{cursor:"default"}},n.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},n.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},n.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${J.label}`]:{[`&.${J.disabled}`]:{color:(r.vars||r).palette.text.disabled}}})),ct=L("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(r,n)=>n.asterisk})(({theme:r})=>({[`&.${J.error}`]:{color:(r.vars||r).palette.error.main}})),ut=C.forwardRef(function(n,d){var s,t;const h=le({props:n,name:"MuiFormControlLabel"}),{className:c,componentsProps:m={},control:l,disabled:S,disableTypography:j,label:i,labelPlacement:a="end",required:B,slotProps:u={}}=h,p=oe(h,it),x=fe(),y=(s=S??l.props.disabled)!=null?s:x==null?void 0:x.disabled,f=B??l.props.required,I={disabled:y,required:f};["checked","name","onChange","value","inputRef"].forEach(G=>{typeof l.props[G]>"u"&&typeof h[G]<"u"&&(I[G]=h[G])});const q=be({props:h,muiFormControl:x,states:["error"]}),A=R({},h,{disabled:y,labelPlacement:a,required:f,error:q.error}),b=lt(A),T=(t=u.typography)!=null?t:m.typography;let k=i;return k!=null&&k.type!==H&&!j&&(k=e.jsx(H,R({component:"span"},T,{className:K(b.label,T==null?void 0:T.className),children:k}))),e.jsxs(dt,R({className:K(b.root,c),ownerState:A,ref:d},p,{children:[C.cloneElement(l,I),k,f&&e.jsxs(ct,{ownerState:A,"aria-hidden":!0,className:b.asterisk,children:["â€‰","*"]})]}))}),X=ut;function mt(r){return ie("MuiFormGroup",r)}se("MuiFormGroup",["root","row","error"]);const ht=["className","row"],pt=r=>{const{classes:n,row:d,error:s}=r;return de({root:["root",d&&"row",s&&"error"]},mt,n)},xt=L("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(r,n)=>{const{ownerState:d}=r;return[n.root,d.row&&n.row]}})(({ownerState:r})=>R({display:"flex",flexDirection:"column",flexWrap:"wrap"},r.row&&{flexDirection:"row"})),gt=C.forwardRef(function(n,d){const s=le({props:n,name:"MuiFormGroup"}),{className:t,row:h=!1}=s,c=oe(s,ht),m=fe(),l=be({props:s,muiFormControl:m,states:["error"]}),S=R({},s,{row:h,error:l.error}),j=pt(S);return e.jsx(xt,R({className:K(j.root,t),ownerState:S,ref:d},c))}),ft=gt,bt=je(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),jt=je(e.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),vt=L("span")({position:"relative",display:"flex"}),Ct=L(bt)({transform:"scale(1)"}),yt=L(jt)(({theme:r,ownerState:n})=>R({left:0,position:"absolute",transform:"scale(0)",transition:r.transitions.create("transform",{easing:r.transitions.easing.easeIn,duration:r.transitions.duration.shortest})},n.checked&&{transform:"scale(1)",transition:r.transitions.create("transform",{easing:r.transitions.easing.easeOut,duration:r.transitions.duration.shortest})}));function Re(r){const{checked:n=!1,classes:d={},fontSize:s}=r,t=R({},r,{checked:n});return e.jsxs(vt,{className:d.root,ownerState:t,children:[e.jsx(Ct,{fontSize:s,className:d.background,ownerState:t}),e.jsx(yt,{fontSize:s,className:d.dot,ownerState:t})]})}const St=C.createContext(void 0),Be=St;function wt(){return C.useContext(Be)}function Rt(r){return ie("MuiRadio",r)}const Bt=se("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),pe=Bt,Tt=["checked","checkedIcon","color","icon","name","onChange","size","className"],kt=r=>{const{classes:n,color:d}=r,s={root:["root",`color${te(d)}`]};return R({},n,de(s,Rt,n))},Pt=L(nt,{shouldForwardProp:r=>Pe(r)||r==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(r,n)=>{const{ownerState:d}=r;return[n.root,n[`color${te(d.color)}`]]}})(({theme:r,ownerState:n})=>R({color:(r.vars||r).palette.text.secondary},!n.disableRipple&&{"&:hover":{backgroundColor:r.vars?`rgba(${n.color==="default"?r.vars.palette.action.activeChannel:r.vars.palette[n.color].mainChannel} / ${r.vars.palette.action.hoverOpacity})`:Ie(n.color==="default"?r.palette.action.active:r.palette[n.color].main,r.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},n.color!=="default"&&{[`&.${pe.checked}`]:{color:(r.vars||r).palette[n.color].main}},{[`&.${pe.disabled}`]:{color:(r.vars||r).palette.action.disabled}}));function It(r,n){return typeof n=="object"&&n!==null?r===n:String(r)===String(n)}const xe=e.jsx(Re,{checked:!0}),ge=e.jsx(Re,{}),Dt=C.forwardRef(function(n,d){var s,t;const h=le({props:n,name:"MuiRadio"}),{checked:c,checkedIcon:m=xe,color:l="primary",icon:S=ge,name:j,onChange:i,size:a="medium",className:B}=h,u=oe(h,Tt),p=R({},h,{color:l,size:a}),x=kt(p),y=wt();let f=c;const I=De(i,y&&y.onChange);let q=j;return y&&(typeof f>"u"&&(f=It(y.value,h.value)),typeof q>"u"&&(q=y.name)),e.jsx(Pt,R({type:"radio",icon:C.cloneElement(S,{fontSize:(s=ge.props.fontSize)!=null?s:a}),checkedIcon:C.cloneElement(m,{fontSize:(t=xe.props.fontSize)!=null?t:a}),ownerState:p,classes:x,name:q,checked:f,onChange:I,ref:d,className:K(x.root,B)},u))}),ee=Dt,Mt=["actions","children","defaultValue","name","onChange","value"],Ft=C.forwardRef(function(n,d){const{actions:s,children:t,defaultValue:h,name:c,onChange:m,value:l}=n,S=oe(n,Mt),j=C.useRef(null),[i,a]=Me({controlled:l,default:h,name:"RadioGroup"});C.useImperativeHandle(s,()=>({focus:()=>{let x=j.current.querySelector("input:not(:disabled):checked");x||(x=j.current.querySelector("input:not(:disabled)")),x&&x.focus()}}),[]);const B=Fe(d,j),u=$e(c),p=C.useMemo(()=>({name:u,onChange(x){a(x.target.value),m&&m(x,x.target.value)},value:i}),[u,m,a,i]);return e.jsx(Be.Provider,{value:p,children:e.jsx(ft,R({role:"radiogroup",ref:B},S,{children:t}))})}),Te=Ft,$t=C.memo(r=>{const n=JSON.parse(sessionStorage.getItem("user")),d=z();let{count:s=0,items:t=[],onDeselectAll:h,onDeselectOne:c,onSelectAll:m,onSelectOne:l,selected:S=[],isLoading:j,isError:i}=r;const[a,B]=C.useState(0),[u,p]=C.useState(25),{t:x,i18n:y}=N(),f=(b,T)=>{let k=t.filter(G=>G.id==b);d(g.actions.setCurrentData(k[0])),d(T?g.actions.openCloseModalUpdate():g.actions.openCloseModalDelete())},I=(b,T)=>{B(T)},q=b=>{p(parseInt(b.target.value,10)),B(0)},A=t==null?void 0:t.slice(a*u,a*u+u);return e.jsxs(_e,{sx:{position:"relative"},children:[e.jsx(We,{component:Ne,children:e.jsxs(Ee,{sx:{minWidth:700},children:[e.jsx(Le,{children:e.jsxs(ne,{children:[e.jsx(w,{children:n!=null&&n.is_eleveur?x(o.batiment.Nom):x(o.fournisseur.Nom)}),e.jsx(w,{children:x(o.magazin.title)}),e.jsx(w,{children:x(o.sortie.eggType)}),e.jsx(w,{children:x(o.entrer.quantity)}),e.jsx(w,{children:x(o.entrer.date)}),e.jsx(w,{children:x(o.entrer.temps)}),e.jsx(w,{})]})}),j?e.jsx(Ye,{rowsNum:10}):e.jsx(ze,{children:A.length>0?A.map(b=>{let T=new Date(b.date),k={year:T.getFullYear(),month:`${T.getMonth()+1}`,day:`${T.getDate()}`};return e.jsxs(ne,{hover:!0,children:[e.jsx(w,{children:b.eggsource_name}),e.jsx(w,{children:b.warehouse_name}),e.jsx(w,{children:b.eggclass_name}),e.jsxs(w,{sx:{direction:y.language=="ar"?"rtl":"ltr",whiteSpace:"nowrap"},children:[b.is_positive?"+":"-",b.value.toLocaleString("en-US").replaceAll(","," ")]}),e.jsxs(w,{children:[k.day.padStart(2,0),"/",k.month.padStart(2,0),"/",k.year]}),e.jsx(w,{children:b.time.substring(0,5)}),e.jsxs(w,{children:[e.jsx(he,{color:"warning",onClick:()=>f(b.id,!0),children:e.jsx(ae,{children:e.jsx(Ue,{})})}),e.jsx(he,{color:"error",onClick:()=>f(b.id,!1),children:e.jsx(ae,{children:e.jsx(He,{})})})]})]},b.id)}):e.jsx(ne,{children:e.jsx(w,{colSpan:5,sx:{textAlign:"center"},children:x(o.batiment.nothingToDisplay)})})})]})}),e.jsx(Ae,{component:"div",count:s,onPageChange:I,onRowsPerPageChange:q,page:a,rowsPerPage:u,rowsPerPageOptions:[5,10,25],labelRowsPerPage:x(o.batiment.Lignes),labelDisplayedRows:({from:b,to:T,count:k})=>`${b}â€“${T} ${x(o.batiment.sur)} ${k}`}),i&&e.jsx(Je,{})]})});function _t({batiment:r,magazin:n,eggType:d}){Ge.locale("fr");const{t:s,i18n:t}=N(),h=z(),c=JSON.parse(sessionStorage.getItem("user")),m=ue({initialValues:{warehouse:"",eggsource:"",classe:""},validationSchema:me({}),onSubmit:async(l,{resetForm:S,setErrors:j})=>{let i="";for(let a in l)i==""?i+=`?${a}=${l[a]}`:i+=`&${a}=${l[a]}`;Q.get("/inventory/list/"+i).then(a=>{h(g.actions.fetchInventaire(a.data))})},onReset:()=>{Q.get("/inventory/list/").then(l=>{h(g.actions.fetchInventaire(l.data))})}});return e.jsxs(Ze,{defaultExpanded:!0,children:[e.jsx(Ke,{expandIcon:e.jsx(tt,{}),"aria-controls":"panel1-content",id:"panel1-header",children:e.jsxs("h3",{className:"font-bold text-lg",children:[e.jsx(Xe,{}),s(o.global.filter)]})}),e.jsx(et,{children:e.jsx(Se,{children:e.jsx(Qe,{children:e.jsx("form",{noValidate:!0,onSubmit:m.handleSubmit,onReset:m.handleReset,children:e.jsxs(v,{container:!0,alignItems:"center",gap:2,children:[e.jsx(v,{item:!0,xs:12,md:2,sm:12,children:e.jsxs(D,{fullWidth:!0,children:[e.jsx(F,{id:"batiment-id",children:c!=null&&c.is_eleveur?s(o.batiment.Nom):s(o.fournisseur.Nom)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:m.handleBlur,fullWidth:!0,name:"eggsource",onChange:m.handleChange,value:m.values.eggsource,label:c!=null&&c.is_eleveur?s(o.batiment.Nom):s(o.fournisseur.Nom),children:r==null?void 0:r.map(l=>e.jsx(P,{value:l.id,children:l.name}))})]})}),e.jsx(v,{items:!0,xs:12,md:2,sm:12,children:e.jsxs(D,{fullWidth:!0,children:[e.jsx(F,{id:"batiment-id",children:s(o.magazin.Nom)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:m.handleBlur,fullWidth:!0,name:"warehouse",onChange:m.handleChange,value:m.values.warehouse,label:s(o.batiment.Nom),children:n==null?void 0:n.map(l=>e.jsx(P,{value:l.id,children:l.name}))})]})}),e.jsx(v,{items:!0,xs:12,md:2,sm:12,children:e.jsxs(D,{fullWidth:!0,children:[e.jsx(F,{id:"batiment-id",children:s(o.magazin.Nom)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:m.handleBlur,fullWidth:!0,name:"warehouse",onChange:m.handleChange,value:m.values.classe,label:s(o.sortie.eggType),children:d==null?void 0:d.map(l=>e.jsx(P,{value:l.id,children:l.value}))})]})}),e.jsxs(v,{item:!0,container:!0,xs:12,md:2,sm:12,gap:2,sx:{alignContent:"center",justifyContent:"end"},children:[e.jsx(v,{items:!0,children:e.jsx(Z,{variant:"contained",type:"reset",children:s(o.global.reset)})}),e.jsx(v,{items:!0,children:e.jsx(Z,{type:"submit",variant:"contained",children:s(o.global.filter)})})]})]})})})})})]})}function Nt(){const r=z(),{t:n,i18n:d}=N(),{inventaire:s}=Y(l=>l.inventaire),t=W("inventaire",E.getInventaire),h=W("batiments",E.getBatimentSelect),c=W("magazin",E.getWarehouseSelect),m=W("class",E.getClass);return C.useEffect(()=>{t.status=="success"&&r(g.actions.fetchInventaire(t.data))},[t.status]),e.jsx(ot,{maxWidth:"xl",children:e.jsxs(U,{spacing:4,children:[e.jsxs(U,{direction:"row",justifyContent:"space-between",spacing:4,children:[e.jsx(U,{spacing:1,children:e.jsx(H,{variant:"h4",children:n(o.inventaire.title)})}),e.jsx(U,{alignItems:"center",direction:"row",spacing:3,children:e.jsx(Z,{startIcon:e.jsx(ae,{children:e.jsx(Ve,{})}),variant:"contained",onClick:()=>r(g.actions.openCloseModalAdd()),children:n(o.global.ajouter)})})]}),e.jsxs(Se,{children:[e.jsx(_t,{batiment:h.data,magazin:c.data,eggType:m.data}),e.jsx($t,{items:s,isLoading:t.isLoading,count:s.length,rowsPerPage:25,isError:t.isError})]})]})})}function ke({confirmed:r}){const{currentData:n,isConfirm:d}=Y(m=>m.inventaire),s=z(),{t,i18n:h}=N(),c=()=>{r()};return e.jsx(re,{open:d,onClose:()=>s(g.actions.openCloseConfirm()),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:e.jsx(rt,{title:t(o.global.confirmOperation),message:t(o.global.confirmMessage),confirmFn:c,cancel:()=>s(g.actions.openCloseConfirm())})})}const qt={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function Wt({batiment:r,magazin:n,eggType:d}){O.locale("fr");const s=z(),{t,i18n:h}=N(),[c,m]=C.useState(new Date),l=JSON.parse(sessionStorage.getItem("user")),{isModalUpdate:S,currentData:j}=Y(p=>p.inventaire),i=me({eggsource:_().required(l!=null&&l.is_eleveur?t(o.entrer.batimentRequired):t(o.entrer.fournisseurRequired)),warehouse:_().required(t(o.entrer.magazinRequired)),option:_().required(t(o.sortie.optionRequired)),value:_().required(t(o.sortie.quantityRequired))}),a=ue({initialValues:{eggsource:"",warehouse:"",option:"",value:"",is_positive:"true",dateTime:""},validationSchema:i,onSubmit:async(p,{resetForm:x,setErrors:y})=>{let f={...p};f.date=O(c).format("YYYY-MM-DD"),f.time=O(c).format("LT"),f.is_positive=f.is_positive=="true",Q.put("/inventory/update/",f).then(I=>{s(g.actions.editInventaire(I.data)),s(g.actions.openCloseModalUpdate()),s(g.actions.openCloseConfirm()),M.success(t(o.inventaire.toastAddSuccess)),x()}).catch(I=>{if(s(g.actions.openCloseConfirm()),I.response.data==2){M.error(t(o.sortie.outOfStock));return}else I.response.data==1?M.error(t(o.sortie.noStockExist)):M.error(t(o.sortie.toastError))})}}),B=p=>{p.preventDefault(),s(g.actions.openCloseConfirm())},u=()=>{a.handleSubmit()};return C.useEffect(()=>{a.setValues(j),j.is_positive?a.setFieldValue("is_positive","true"):a.setFieldValue("is_positive","false"),m(new Date(`${j.date}T${j.time}`)),a.setFieldValue("dateTime",new Date,!1)},[]),e.jsxs(e.Fragment,{children:[e.jsx(re,{open:S,onClose:()=>s(g.actions.openCloseModalUpdate()),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(ce,{sx:qt,children:[e.jsxs(U,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"20px"},children:[e.jsx(H,{id:"modal-modal-title",variant:"h6",component:"h2",children:t(o.inventaire.update)}),e.jsx("div",{className:"cursor-pointer",onClick:()=>s(g.actions.openCloseModalUpdate()),children:e.jsx(ye,{})})]}),e.jsxs("form",{noValidate:!0,onSubmit:p=>B(p),children:[e.jsxs(v,{container:!0,spacing:2,children:[e.jsx(v,{item:!0,xs:12,md:6,children:e.jsxs(D,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(a.touched.eggsource&&a.errors.eggsource),children:[e.jsx(F,{id:"batiment-id",children:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:a.handleBlur,fullWidth:!0,name:"eggsource",onChange:a.handleChange,value:a.values.eggsource,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:r.length>0?r.map(p=>e.jsx(P,{value:p.id,children:p.name})):e.jsx(P,{children:t(o.batiment.nothingToDisplay)})}),a.touched.eggsource&&a.errors.eggsource&&e.jsx(V,{children:a.errors.eggsource})]})}),e.jsx(v,{item:!0,xs:12,md:6,children:e.jsxs(D,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(a.touched.warehouse&&a.errors.warehouse),children:[e.jsx(F,{id:"batiment-id",children:t(o.magazin.title)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:a.handleBlur,fullWidth:!0,name:"warehouse",onChange:a.handleChange,value:a.values.warehouse,label:t(o.magazin.title),children:n.length>0?n.map(p=>e.jsx(P,{value:p.id,children:p.name})):e.jsx(P,{children:t(o.batiment.nothingToDisplay)})}),a.touched.warehouse&&a.errors.warehouse&&e.jsx(V,{children:a.errors.warehouse})]})}),e.jsx(v,{item:!0,xs:12,md:6,children:e.jsxs(D,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(a.touched.option&&a.errors.option),children:[e.jsx(F,{id:"batiment-id",children:t(o.sortie.eggType)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:a.handleBlur,fullWidth:!0,name:"option",onChange:a.handleChange,value:a.values.option,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:d.map(p=>e.jsx(P,{value:p.id,children:p.value}))}),a.touched.option&&a.errors.option&&e.jsx(V,{children:a.errors.option})]})}),e.jsx(v,{item:!0,xs:12,md:6,children:e.jsx(we,{id:"outlined-basic",label:t(o.entrer.temps)+" "+t(o.entrer.date),variant:"outlined",onBlur:a.handleBlur,fullWidth:!0,name:"dateTime",value:c,onChange:p=>{a.setFieldValue("dateTime",p,!0),m(p)},slotProps:{textField:{variant:"outlined",error:!!(a.touched.dateTime&&a.errors.dateTime),helperText:!!(a.touched.dateTime&&a.errors.dateTime)}},sx:{marginBottom:"15px",marginTop:"5px",width:"100%"}})}),e.jsxs(v,{item:!0,xs:12,children:[e.jsx(ve,{id:"outlined-basic",label:t(o.entrer.quantity),variant:"outlined",fullWidth:!0,type:"number",onBlur:a.handleBlur,onChange:a.handleChange,value:a.values.value,error:!!(a.touched.value&&a.errors.value),helperText:a.touched.value&&a.errors.value,name:"value",style:{marginBottom:"1px"}}),e.jsx(D,{children:e.jsxs(Te,{"aria-labelledby":"demo-radio-buttons-group-label",value:a.values.is_positive,onBlur:a.handleBlur,onChange:a.handleChange,name:"is_positive",children:[e.jsx(X,{name:"is_positive",value:"true",control:e.jsx(ee,{}),label:t(o.inventaire.increaseStock)}),e.jsx(X,{name:"is_positive",value:"false",control:e.jsx(ee,{}),label:t(o.inventaire.decreaseStock)})]})})]})]}),e.jsx(Z,{fullWidth:!0,size:"large",sx:{mt:2},type:"submit",variant:"contained",children:t(o.global.modifier)})]})]})}),e.jsx(ke,{confirmed:u})]})}const Et={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function Lt({batiment:r,magazin:n,eggType:d}){O.locale("fr");const s=z(),{t,i18n:h}=N(),[c,m]=C.useState(new Date),l=JSON.parse(sessionStorage.getItem("user")),{isModalAdd:S}=Y(u=>u.inventaire),j=me({eggsource:_().required(l!=null&&l.is_eleveur?t(o.entrer.batimentRequired):t(o.entrer.fournisseurRequired)),warehouse:_().required(t(o.entrer.magazinRequired)),option:_().required(t(o.sortie.optionRequired)),value:_().required(t(o.sortie.quantityRequired))}),i=ue({initialValues:{eggsource:"",warehouse:"",option:"",value:"",is_positive:"true",dateTime:""},validationSchema:j,onSubmit:async(u,{resetForm:p,setErrors:x})=>{let y={...u};y.date=O(c).format("YYYY-MM-DD"),y.time=O(c).format("LT"),y.is_positive=y.is_positive=="true",Q.post("/inventory/add/",y).then(f=>{s(g.actions.addInventaire(f.data)),s(g.actions.openCloseModalAdd()),s(g.actions.openCloseConfirm()),M.success(t(o.inventaire.toastAddSuccess)),p()}).catch(f=>{if(s(g.actions.openCloseConfirm()),f.response.data==2){M.error(t(o.sortie.outOfStock));return}else f.response.data==1?M.error(t(o.sortie.noStockExist)):M.error(t(o.sortie.toastError))})}}),a=u=>{u.preventDefault(),s(g.actions.openCloseConfirm())},B=()=>{i.handleSubmit()};return e.jsxs(e.Fragment,{children:[e.jsx(re,{open:S,onClose:()=>s(g.actions.openCloseModalAdd()),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(ce,{sx:Et,children:[e.jsxs(U,{direction:"row",justifyContent:"space-between",alignItems:"center",style:{marginBottom:"20px"},children:[e.jsx(H,{id:"modal-modal-title",variant:"h6",component:"h2",children:t(o.inventaire.add)}),e.jsx("div",{className:"cursor-pointer",onClick:()=>s(g.actions.openCloseModalAdd()),children:e.jsx(ye,{})})]}),e.jsxs("form",{noValidate:!0,onSubmit:u=>a(u),children:[e.jsxs(v,{container:!0,spacing:2,children:[e.jsx(v,{item:!0,xs:12,md:6,children:e.jsxs(D,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(i.touched.eggsource&&i.errors.eggsource),children:[e.jsx(F,{id:"batiment-id",children:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:i.handleBlur,fullWidth:!0,name:"eggsource",onChange:i.handleChange,value:i.values.eggsource,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:r.length>0?r.map(u=>e.jsx(P,{value:u.id,children:u.name})):e.jsx(P,{children:t(o.batiment.nothingToDisplay)})}),i.touched.eggsource&&i.errors.eggsource&&e.jsx(V,{children:i.errors.eggsource})]})}),e.jsx(v,{item:!0,xs:12,md:6,children:e.jsxs(D,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(i.touched.warehouse&&i.errors.warehouse),children:[e.jsx(F,{id:"batiment-id",children:t(o.magazin.title)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:i.handleBlur,fullWidth:!0,name:"warehouse",onChange:i.handleChange,value:i.values.warehouse,label:t(o.magazin.title),children:n.length>0?n.map(u=>e.jsx(P,{value:u.id,children:u.name})):e.jsx(P,{children:t(o.batiment.nothingToDisplay)})}),i.touched.warehouse&&i.errors.warehouse&&e.jsx(V,{children:i.errors.warehouse})]})}),e.jsx(v,{item:!0,xs:12,md:6,children:e.jsxs(D,{style:{marginBottom:"15px"},fullWidth:!0,error:!!(i.touched.option&&i.errors.option),children:[e.jsx(F,{id:"batiment-id",children:t(o.sortie.eggType)}),e.jsx($,{labelId:"batiment-id",id:"demo-simple-select",onBlur:i.handleBlur,fullWidth:!0,name:"option",onChange:i.handleChange,value:i.values.option,label:l!=null&&l.is_eleveur?t(o.batiment.Nom):t(o.fournisseur.Nom),children:d.map(u=>e.jsx(P,{value:u.id,children:u.value}))}),i.touched.option&&i.errors.option&&e.jsx(V,{children:i.errors.option})]})}),e.jsx(v,{item:!0,xs:12,md:6,children:e.jsx(we,{id:"outlined-basic",label:t(o.entrer.temps)+" "+t(o.entrer.date),variant:"outlined",onBlur:i.handleBlur,fullWidth:!0,name:"dateTime",value:c,onChange:u=>{i.setFieldValue("dateTime",u,!0),m(u)},slotProps:{textField:{variant:"outlined",error:!!(i.touched.dateTime&&i.errors.dateTime),helperText:!!(i.touched.dateTime&&i.errors.dateTime)}},sx:{marginBottom:"15px",marginTop:"5px",width:"100%"}})}),e.jsxs(v,{item:!0,xs:12,children:[e.jsx(ve,{id:"outlined-basic",label:t(o.entrer.quantity),variant:"outlined",fullWidth:!0,type:"number",onBlur:i.handleBlur,onChange:i.handleChange,value:i.values.value,error:!!(i.touched.value&&i.errors.value),helperText:i.touched.value&&i.errors.value,name:"value",style:{marginBottom:"1px"}}),e.jsx(D,{children:e.jsxs(Te,{"aria-labelledby":"demo-radio-buttons-group-label",value:i.values.is_positive,onBlur:i.handleBlur,onChange:i.handleChange,name:"is_positive",children:[e.jsx(X,{name:"is_positive",value:"true",control:e.jsx(ee,{}),label:t(o.inventaire.increaseStock)}),e.jsx(X,{name:"is_positive",value:"false",control:e.jsx(ee,{}),label:t(o.inventaire.decreaseStock)})]})})]})]}),e.jsx(Z,{fullWidth:!0,size:"large",sx:{mt:2},type:"submit",variant:"contained",children:t(o.global.ajouter)})]})]})}),e.jsx(ke,{confirmed:B})]})}function zt(){const{currentData:r,isModalDelete:n}=Y(c=>c.inventaire),d=z(),{t:s,i18n:t}=N();JSON.parse(sessionStorage.getItem("user"));const h=()=>{Q.delete(`/inventory/delete/${r.id}`).then(c=>{d(g.actions.deleteInventaire()),d(g.actions.openCloseModalDelete()),M.success(s(o.inventaire.toastDeleteSuccess))}).catch(c=>{d(g.actions.openCloseModalDelete()),M.error(s(o.global.toastError))})};return e.jsx(re,{open:n,onClose:()=>d(g.actions.openCloseModalDelete()),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:e.jsx(Oe,{title:s(o.inventaire.deleteTitle),message:s(o.inventaire.deleteDescription),deleteFn:h,cancel:()=>d(g.actions.openCloseModalDelete())})})}function At(){const{isModalAdd:r,isModalUpdate:n}=Y(h=>h.inventaire),d=W("batiment",E.getBatimentSelect),s=W("magazin",E.getWarehouseSelect),t=W("eggType",E.getClass);return e.jsxs(ce,{component:"main",sx:{flexGrow:1,py:8},children:[e.jsx(Ce,{children:e.jsx(Nt,{})}),r&&e.jsx(Lt,{batiment:d.data,magazin:s.data,eggType:t.data}),n&&e.jsx(Wt,{batiment:d.data,magazin:s.data,eggType:t.data}),e.jsx(zt,{})]})}function no(){const{t:r,i18n:n}=N();return e.jsxs(e.Fragment,{children:[e.jsx(qe,{title:`ESM | ${r(o.nav.inventaire)}`}),e.jsx(Ce,{children:e.jsx(At,{})})]})}export{no as default};
